# Journal Entry 001 - 2026-02-09 - Initial Build

## Goal
Build `rem` from scratch - a full CLI for macOS Reminders with CRUD, date parsing, import/export, interactive mode, and a public Go API.

## Key Engineering Decisions

### AppleScript vs JXA - The Performance Wall

The single biggest challenge was **AppleScript's catastrophic performance with loops**.

**What failed:**
1. **AppleScript `repeat with r in theReminders`** - Iterating through reminders and accessing properties per-element. Even 8 reminders in the Books list caused a timeout (>30s). 90 reminders in Inbox was impossible.
2. **JXA per-element `.properties()` calls** - `reminders.map(r => r.properties())` was equally slow. Each `.properties()` call is a separate Apple Event, so it's O(n) Apple Events.
3. **AppleScript bulk `id of theReminders`** with a `whose` clause - returned reminder references instead of simple values, causing `Can't get id of {reminder...}` errors.

**What succeeded:**
- **JXA columnar bulk access**: `list.reminders.name()` returns ALL names as a single array in ONE Apple Event. Same for `.id()`, `.completed()`, `.flagged()`, `.priority()`, `.dueDate()`, etc.
- This is instant even for 90+ reminders because it's a single IPC call per property.
- For all-lists queries, iterate through each list and bulk-access per list.

**Architecture result:** JXA for all reads (listing, getting), AppleScript for all writes (create, update, delete). Writes are single-item operations so AppleScript's simplicity wins there.

### Date Parsing - No External Deps

Built a custom NL date parser in `internal/parser/` instead of using `olebedev/when`. Handles:
- Relative: `in 2 days`, `in 3 hours`, `in 30 minutes`
- Named: `today`, `tomorrow`, `next monday`, `eod`, `next week`
- Compound: `next friday at 2pm`, `tomorrow at 3:30pm`
- Standalone time: `5pm`, `17:00` (auto-picks today or tomorrow)
- Standard formats: ISO, US, European

### tablewriter v1.x API Change

`olekukonko/tablewriter` had a major API rewrite. The old `SetHeader()`/`SetBorder()`/`Append()`/`Render()` API is gone. New API:
```go
table := tablewriter.NewTable(os.Stdout,
    tablewriter.WithHeaderAlignment(tw.AlignLeft),
    tablewriter.WithRowAlignment(tw.AlignLeft),
)
table.Header("Col1", "Col2")
table.Append([]string{"val1", "val2"})
table.Render()
```

### Reminders API Quirks Discovered
- **No URL property** - SDEF confirms it. URLs must be embedded in `body` field.
- **No tags** - Tags visible in Reminders UI are not in the scripting dictionary.
- **No subtasks** - Sub-reminders are completely invisible to AppleScript/JXA.
- **No move command** - Must delete + recreate to move between lists.
- **`body` not `notes`** - The notes field is called `body` in the scripting dictionary.
- **`remind me date` is independent of `due date`** - Setting one doesn't set the other. In the UI they appear linked but via script they're separate.
- **Priority values are inverted** - Lower number = higher priority. Only 0, 1, 5, 9 are used by the UI but the full 0-9 range works.
- **Date strings are locale-dependent** in AppleScript. JXA's `.toISOString()` returns UTC ISO 8601 which is reliable and portable.

### JXA Date Handling
JXA's `Date.toISOString()` returns UTC. Must convert to local time when parsing:
```go
t, _ := time.Parse(time.RFC3339, isoString)
local := t.Local()
```

## What Was Built
- 15 CLI commands (add, list, show, update, delete, complete, uncomplete, flag, unflag, search, stats, overdue, upcoming, export, import, interactive, version)
- Public Go API in `pkg/client/`
- 30+ unit tests (date parser, JSON/CSV round-trip, priority parsing, special chars)
- Shell completions (bash, zsh, fish)
- Full E2E tested: create with all props → show → update → flag → complete → delete

## Files Created
- 34 source files across `cmd/`, `internal/`, `pkg/`
- 3 test files
- Makefile, README.md, LICENSE, .gitignore

---
